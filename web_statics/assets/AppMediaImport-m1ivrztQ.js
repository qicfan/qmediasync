import{d as D,i as M,r as y,a as N,b as r,c as C,e as t,w as a,o as x,f as e,u as k,g as T,h as o,k as U,l as P,m as R,j as h,t as q,S as z,E as w,_ as A}from"./index-Dqp3gZ1f.js";const J={class:"media-import-container"},L={class:"import-content"},F={class:"import-section"},O={class:"section-title"},W={key:1,class:"progress-section"},G={class:"progress-text"},H=D({__name:"AppMediaImport",setup(K){const g=M("$http"),p=y(!1),u=y(null),s=y({visible:!1,percentage:0,status:void 0,text:""}),i=N({library_path:"",file_types:["video","audio"],target_dir:""}),E=async()=>{var b,l,c;if($())try{p.value=!0,u.value=null,s.value.visible=!0,s.value.percentage=0,s.value.text="准备扫描媒体库...";const m={library_path:i.library_path,file_types:i.file_types.join(","),target_dir:i.target_dir||"/"};s.value.percentage=30,s.value.text="正在扫描文件...";const n=await(g==null?void 0:g.post(`${z}/import/media-library`,m,{headers:{"Content-Type":"application/json"}}));if(s.value.percentage=100,(n==null?void 0:n.data.code)===200){s.value.status="success",s.value.text="媒体库导入完成！";const d=((b=n.data.data)==null?void 0:b.success_count)||0,v=((l=n.data.data)==null?void 0:l.total_count)||0,f=((c=n.data.data)==null?void 0:c.skipped_count)||0;u.value={title:"媒体库导入完成",type:d===v?"success":"warning",description:`共扫描 ${v} 个文件，成功导入 ${d} 个，跳过 ${f} 个`},w.success(`媒体库导入完成！成功 ${d}/${v} 个文件`)}else s.value.status="exception",s.value.text="媒体库导入失败",u.value={title:"媒体库导入失败",type:"error",description:(n==null?void 0:n.data.message)||"导入过程中发生错误，请检查媒体库路径"}}catch(m){console.error("媒体库导入错误:",m),s.value.status="exception",s.value.text="媒体库导入失败",u.value={title:"媒体库导入出错",type:"error",description:"导入过程中发生网络错误，请检查网络连接"}}finally{p.value=!1,setTimeout(()=>{s.value.visible=!1},3e3)}},$=()=>i.library_path.trim()?i.file_types.length===0?(w.warning("请选择至少一种文件类型"),!1):!0:(w.warning("请输入媒体库路径"),!1),S=()=>{i.library_path="",i.file_types=["video","audio"],i.target_dir="",u.value=null,s.value.visible=!1};return(b,l)=>{const c=r("el-icon"),m=r("el-input"),n=r("el-form-item"),d=r("el-checkbox"),v=r("el-checkbox-group"),f=r("el-button"),j=r("el-form"),I=r("el-alert"),B=r("el-progress"),V=r("el-card");return x(),C("div",J,[t(V,{class:"media-import-card",shadow:"hover"},{header:a(()=>l[3]||(l[3]=[e("h2",{class:"card-title"},"媒体库导入",-1),e("p",{class:"card-subtitle"},"从媒体库管理工具导入文件到115网盘",-1)])),default:a(()=>[e("div",L,[e("div",F,[e("h3",O,[t(c,null,{default:a(()=>[t(k(T))]),_:1}),l[4]||(l[4]=o(" 媒体库导入 "))]),l[14]||(l[14]=e("p",{class:"section-description"},"支持从Jellyfin、Emby、Plex等媒体库管理工具导入文件",-1)),t(j,{model:i,"label-position":"top",class:"import-form"},{default:a(()=>[t(n,{label:"媒体库路径",required:""},{default:a(()=>[t(m,{modelValue:i.library_path,"onUpdate:modelValue":l[0]||(l[0]=_=>i.library_path=_),type:"textarea",rows:3,placeholder:"请输入媒体库路径，支持多个路径，每行一个",disabled:p.value},null,8,["modelValue","disabled"]),l[5]||(l[5]=e("div",{class:"form-help"},"输入媒体库的文件夹路径，系统将扫描这些路径下的媒体文件",-1))]),_:1}),t(n,{label:"文件类型过滤"},{default:a(()=>[t(v,{modelValue:i.file_types,"onUpdate:modelValue":l[1]||(l[1]=_=>i.file_types=_),disabled:p.value},{default:a(()=>[t(d,{label:"video"},{default:a(()=>l[6]||(l[6]=[o("视频文件 (.mp4, .mkv, .avi, .mov等)")])),_:1}),t(d,{label:"audio"},{default:a(()=>l[7]||(l[7]=[o("音频文件 (.mp3, .flac, .wav, .aac等)")])),_:1}),t(d,{label:"subtitle"},{default:a(()=>l[8]||(l[8]=[o("字幕文件 (.srt, .ass, .vtt等)")])),_:1}),t(d,{label:"image"},{default:a(()=>l[9]||(l[9]=[o("图像文件 (.jpg, .png, .gif等)")])),_:1})]),_:1},8,["modelValue","disabled"]),l[10]||(l[10]=e("div",{class:"form-help"},"选择要导入的文件类型，不选择表示导入所有支持的文件类型",-1))]),_:1}),t(n,{label:"目标目录"},{default:a(()=>[t(m,{modelValue:i.target_dir,"onUpdate:modelValue":l[2]||(l[2]=_=>i.target_dir=_),placeholder:"目标目录路径，留空表示根目录",disabled:p.value,clearable:""},null,8,["modelValue","disabled"]),l[11]||(l[11]=e("div",{class:"form-help"}," 上传到115网盘的目标目录，例如：/媒体库，留空表示上传到根目录 ",-1))]),_:1}),t(n,null,{default:a(()=>[t(f,{type:"primary",onClick:E,loading:p.value,size:"large"},{default:a(()=>[t(c,null,{default:a(()=>[t(k(U))]),_:1}),l[12]||(l[12]=o(" 开始导入 "))]),_:1},8,["loading"]),t(f,{type:"warning",onClick:S,disabled:p.value,size:"large"},{default:a(()=>[t(c,null,{default:a(()=>[t(k(P))]),_:1}),l[13]||(l[13]=o(" 重置表单 "))]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model"])]),u.value?(x(),R(I,{key:0,title:u.value.title,type:u.value.type,description:u.value.description,closable:!1,"show-icon":"",class:"import-status"},null,8,["title","type","description"])):h("",!0),s.value.visible?(x(),C("div",W,[l[15]||(l[15]=e("h4",null,"导入进度",-1)),t(B,{percentage:s.value.percentage,status:s.value.status,"show-text":!0},null,8,["percentage","status"]),e("p",G,q(s.value.text),1)])):h("",!0)])]),_:1}),t(V,{class:"usage-card",shadow:"hover"},{header:a(()=>l[16]||(l[16]=[e("h2",{class:"card-title"},"使用说明",-1),e("p",{class:"card-subtitle"},"如何配置媒体库导入",-1)])),default:a(()=>[l[17]||(l[17]=e("div",{class:"usage-content"},[e("div",{class:"usage-section"},[e("h4",null,"支持的媒体库："),e("ul",null,[e("li",null,[e("strong",null,"Jellyfin："),o("开源媒体服务器")]),e("li",null,[e("strong",null,"Emby："),o("媒体服务器")]),e("li",null,[e("strong",null,"Plex："),o("媒体服务器")]),e("li",null,[e("strong",null,"本地文件夹："),o("任意包含媒体文件的文件夹")])])]),e("div",{class:"usage-section"},[e("h4",null,"路径格式示例："),e("ul",null,[e("li",null,[o("Windows: "),e("code",null,"D:\\Movies"),o(", "),e("code",null,"E:\\TV Shows")]),e("li",null,[o("Linux/macOS: "),e("code",null,"/media/movies"),o(", "),e("code",null,"/media/tv")]),e("li",null,[o("网络路径: "),e("code",null,"\\\\\\\\192.168.1.100\\\\media")])])]),e("div",{class:"usage-section"},[e("h4",null,"注意事项："),e("ul",null,[e("li",null,"确保服务器有权限访问指定的媒体库路径"),e("li",null,"大型媒体库的扫描可能需要较长时间"),e("li",null,"建议在网络空闲时进行大批量导入"),e("li",null,"重复文件会自动跳过，不会重复上传")])])],-1))]),_:1})])}}}),X=A(H,[["__scopeId","data-v-fbf2fc39"]]);export{X as default};
