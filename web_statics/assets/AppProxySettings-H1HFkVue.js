import{d as T,r as p,i as E,a as S,v as $,b as n,c as j,e as a,w as r,m as B,j as M,x as N,S as u,o as f,f as d,u as x,y as D,h as v,z as R,E as q,_ as A}from"./index-CSz3_bFc.js";const H={class:"main-content-container proxy-section"},I={class:"form-actions"},L=T({__name:"AppProxySettings",setup(U){const b=p(N()),l=E("$http"),i=p(!1),c=p(!1),o=p(null),s=S({proxy_url:""}),g=async()=>{if(!s.proxy_url.trim()){q.warning("请输入代理服务器地址");return}try{c.value=!0,o.value=null;const t={http_proxy:s.proxy_url},e=await(l==null?void 0:l.post(`${u}/setting/test-http-proxy`,t,{headers:{"Content-Type":"application/json"}}));(e==null?void 0:e.data.code)===200?o.value={title:"代理测试成功",type:"success",description:"代理服务器连接正常，可以正常使用"}:o.value={title:"代理测试失败",type:"error",description:(e==null?void 0:e.data.message)||"无法连接到代理服务器，请检查配置"}}catch(t){console.error("代理测试错误:",t),o.value={title:"代理测试出错",type:"error",description:"测试过程中发生错误，请检查网络连接和代理设置"}}finally{c.value=!1}},h=async()=>{try{i.value=!0,o.value=null;const t={http_proxy:s.proxy_url},e=await(l==null?void 0:l.post(`${u}/setting/http-proxy`,t,{headers:{"Content-Type":"application/json"}}));(e==null?void 0:e.data.code)===200?o.value={title:"代理设置已保存",type:"success",description:s.proxy_url?`已设置代理服务器：${s.proxy_url}`:"已清除代理设置，使用直连网络"}:o.value={title:"保存代理设置失败",type:"error",description:(e==null?void 0:e.data.message)||"保存设置失败，请重试"}}catch(t){console.error("保存代理设置错误:",t),o.value={title:"保存设置出错",type:"error",description:"保存过程中发生错误，请检查网络连接"}}finally{i.value=!1}},k=async()=>{try{const t=await(l==null?void 0:l.get(`${u}/setting/http-proxy`));(t==null?void 0:t.data.code)===200&&t.data.data&&(s.proxy_url=t.data.data.http_proxy||"")}catch(t){console.error("加载代理设置错误:",t)}};return $(()=>{k()}),(t,e)=>{const w=n("el-input"),y=n("el-form-item"),_=n("el-icon"),m=n("el-button"),C=n("el-form"),P=n("el-alert");return f(),j("div",H,[a(C,{model:s,"label-position":b.value?"top":"left","label-width":120,class:"proxy-form"},{default:r(()=>[a(y,{label:"HTTP代理地址",prop:"proxy_url"},{default:r(()=>[a(w,{modelValue:s.proxy_url,"onUpdate:modelValue":e[0]||(e[0]=V=>s.proxy_url=V),placeholder:"例如: http://127.0.0.1:7890 或 http://proxy.example.com:8080",disabled:i.value,clearable:""},null,8,["modelValue","disabled"]),e[1]||(e[1]=d("div",{class:"form-help"}," 支持HTTP代理，格式：http://[用户名:密码@]主机:端口，留空表示不使用代理 ",-1))]),_:1}),a(y,null,{default:r(()=>[d("div",I,[d("div",null,[a(m,{type:"primary",onClick:g,loading:c.value,disabled:i.value},{default:r(()=>[a(_,null,{default:r(()=>[a(x(D))]),_:1}),e[2]||(e[2]=v(" 测试 "))]),_:1},8,["loading","disabled"])]),d("div",null,[a(m,{type:"success",onClick:h,loading:i.value,disabled:c.value},{default:r(()=>[a(_,null,{default:r(()=>[a(x(R))]),_:1}),e[3]||(e[3]=v(" 保存 "))]),_:1},8,["loading","disabled"])])])]),_:1})]),_:1},8,["model","label-position"]),o.value?(f(),B(P,{key:0,title:o.value.title,type:o.value.type,description:o.value.description,closable:!1,"show-icon":"",class:"proxy-status"},null,8,["title","type","description"])):M("",!0)])}}}),F=A(L,[["__scopeId","data-v-d63b4431"]]);export{F as default};
